function renderMonthlySummary() {
  const summaryTableBody = document.getElementById("summaryTableBody");
  summaryTableBody.innerHTML = "";

  // Filter requests for the current month
  const monthStr = `${currentYear}-${String(currentMonth + 1).padStart(2, "0")}`;
  const groupedRequests = groupRequestsByStaffID(requests);

  // Process each staff member
  groupedRequests.forEach(group => {
    // Filter days that fall within the current month and have "Approved" or "Write-in" status
    const monthlyLeaves = [];
    group.requests.forEach(req => {
      const daysInMonth = req.days.filter(day => 
        day.date.startsWith(monthStr) && 
        (day.status === "Approved" || day.status === "Write-in")
      );
      if (daysInMonth.length > 0) {
        monthlyLeaves.push({ days: daysInMonth });
      }
    });

    if (monthlyLeaves.length === 0) return; // Skip if no approved or write-in leaves in this month

    // Group consecutive days into ranges
    const ranges = [];
    monthlyLeaves.forEach(leave => {
      leave.days.sort((a, b) => new Date(a.date) - new Date(b.date)); // Sort by date
      let currentRange = [leave.days[0]];
      for (let i = 1; i < leave.days.length; i++) {
        const prevDate = new Date(currentRange[currentRange.length - 1].date);
        const currDate = new Date(leave.days[i].date);
        if (daysBetween(prevDate, currDate) === 1) {
          currentRange.push(leave.days[i]);
        } else {
          ranges.push(currentRange);
          currentRange = [leave.days[i]];
        }
      }
      if (currentRange.length > 0) ranges.push(currentRange);
    });

    // Calculate total days
    const totalDays = monthlyLeaves.reduce((sum, leave) => sum + leave.days.length, 0);

    // Create table row
    const row = document.createElement("tr");
    row.innerHTML = `
      <td class="staff-name">${group.staffName} (${group.staffID})</td>
      <td class="leave-range">
        ${ranges.map(range => {
          const startDate = range[0].date.split('-')[2]; // Get day (e.g., "24")
          const endDate = range[range.length - 1].date.split('-')[2]; // Get day (e.g., "26")
          const displayText = startDate === endDate ? startDate : `${startDate}-${endDate}`;
          
          // Determine the status of the range (all days should be Approved or Write-in)
          const statusClass = range[0].status.toLowerCase();

          return `
            <div class="range-block ${statusClass}">
              <span class="status-dot"></span>
              ${displayText}
            </div>
          `;
        }).join('')}
      </td>
      <td class="total-days">${totalDays}</td>
    `;
    summaryTableBody.appendChild(row);
  });

  // If no leaves, display a message
  if (summaryTableBody.children.length === 0) {
    const row = document.createElement("tr");
    row.innerHTML = `<td colspan="3" style="text-align: center; color: #7f8c8d; font-size: 11px;">No approved or write-in leave requests for this month.</td>`;
    summaryTableBody.appendChild(row);
  }
}