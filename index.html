<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Leave Management System v5.1 (Staff ID Edition)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    /* All existing CSS unchanged */ 
    /* ... (omitted for brevity) ... */
  </style>
</head>
<body>
  <div id="loginSection">
    <h2>Login</h2>
    <button onclick="showAdminLogin()">Login as Admin</button>
    <button onclick="showUserLogin()">Login as User</button>
    <div id="adminLoginForm" style="display:none;">
      <input type="text" id="adminUsername" placeholder="Staff ID">
      <input type="password" id="adminPassword" placeholder="Password">
      <button onclick="loginAdmin()">Login</button>
    </div>
    <div id="userLoginForm" style="display:none;">
      <input type="text" id="userStaffID" placeholder="Staff ID">
      <input type="password" id="userPassword" placeholder="Password">
      <button onclick="loginUser()">Login</button>
    </div>
  </div>

  <div class="container" style="display:none;">
    <h1>Leave Management System <sup>v5.1</sup></h1>
    <div id="adminTabs" style="display:none;">
      <button onclick="showLeaveManagement()">Leave Management</button>
      <button onclick="showUserManagement()">User Management</button>
    </div>
    <!-- Leave Management Panel ... -->
    <div id="leaveManagementPanel"></div>
    <!-- User Management Panel ... -->
    <div id="userManagementPanel" style="display:none;"></div>
  </div>


  <div class="footer">@ 2025; tâ€™va</div>

<script>
  const API_BASE_URL = "https://leave-management.th3va.com";

  async function hashPassword(pwd) {
    const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(pwd));
    return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,"0")).join("");
  }

  function showAdminLogin(){ document.getElementById("adminLoginForm").style.display="block"; }
  function showUserLogin(){ document.getElementById("userLoginForm").style.display="block"; }



  async function loginAdmin() {
    const staff_id = document.getElementById("adminUsername").value.trim();
    const password = await hashPassword(document.getElementById("adminPassword").value);
    const resp = await fetch(`${API_BASE_URL}/api/login`, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ staff_id, password })
    });
    const data = await resp.json();
    if(resp.ok && data.status==="success"){
      localStorage.setItem('token', data.token);
      document.getElementById("loginSection").style.display="none";
      document.querySelector(".container").style.display="block";
      showUserManagement();
    } else alert("Invalid admin credentials.");
  }

  async function loginUser() {
    const staff_id = document.getElementById("userStaffID").value.trim();
    const password = await hashPassword(document.getElementById("userPassword").value);
    const resp = await fetch(`${API_BASE_URL}/api/login`, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ staff_id, password })
    });
    const data = await resp.json();
    if(resp.ok && data.status==="success"){
      localStorage.setItem('token', data.token);
      document.getElementById("loginSection").style.display="none";
      document.querySelector(".container").style.display="block";
      showUserManagement();
    } else alert("Invalid user credentials.");
  }

  /* ...the rest of your JS remains exactly as in v5.1... */
</script>
</body>
</html>